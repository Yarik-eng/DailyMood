{% extends 'base.html' %}

{% block title %}–ú–∞–≥–∞–∑–∏–Ω ‚Äî DailyMood{% endblock %}

{% block content %}
<style>
@keyframes fadeInUp {
  from {
    opacity: 0;
    transform: translateY(20px);
  }
  to {
    opacity: 1;
    transform: translateY(0);
  }
}

@keyframes fadeIn {
  from { opacity: 0; }
  to { opacity: 1; }
}

.store-section {
  animation: fadeInUp 0.6s ease-out forwards;
  opacity: 0;
}

.store-section:nth-child(1) { animation-delay: 0.1s; }
.store-section:nth-child(2) { animation-delay: 0.2s; }
.store-section:nth-child(3) { animation-delay: 0.3s; }
.store-section:nth-child(4) { animation-delay: 0.4s; }

details {
  transition: all 0.3s ease;
  overflow: hidden;
}

details[open] {
  background: rgba(148,163,184,0.08) !important;
}

details summary {
  transition: all 0.2s ease;
  user-select: none;
}

details summary:hover {
  opacity: 0.8;
}

details[open] summary {
  margin-bottom: 12px;
  padding-bottom: 12px;
  border-bottom: 1px solid rgba(148,163,184,0.15);
}

details > *:not(summary) {
  animation: slideDown 0.9s ease-out;
  transform-origin: top;
}

@keyframes slideDown {
  from {
    opacity: 0;
    transform: translateY(-10px);
    max-height: 0;
  }
  to {
    opacity: 1;
    transform: translateY(0);
    max-height: 500px;
  }
}

.benefit-card {
  transition: all 0.3s ease;
  cursor: default;
}

.benefit-card:hover {
  transform: translateY(-4px);
  box-shadow: 0 8px 16px rgba(0,0,0,0.1);
}
</style>
  <section class="page-banner">
    <h1 data-i18n="store_title">–ú–∞–≥–∞–∑–∏–Ω</h1>
  </section>

  <!-- Promo Banner -->
  <section class="store-section" style="margin:20px auto; max-width:1200px; padding:0 16px;">
    <div style="background:linear-gradient(135deg, rgba(139,92,246,0.15) 0%, rgba(59,130,246,0.15) 100%); border:1px solid rgba(139,92,246,0.3); border-radius:16px; padding:24px 28px; text-align:center;">
      <div style="font-size:24px; font-weight:900; margin-bottom:8px; background:linear-gradient(135deg, #8b5cf6 0%, #3b82f6 100%); -webkit-background-clip:text; -webkit-text-fill-color:transparent; background-clip:text;" data-i18n="promo_title">üéâ –°–ø–µ—Ü—ñ–∞–ª—å–Ω–∞ –ø—Ä–æ–ø–æ–∑–∏—Ü—ñ—è</div>
      <p style="margin:0; font-size:15px; opacity:0.9;" data-i18n="promo_desc">–û—Ç—Ä–∏–º–∞–π Premium –∑–∞ —Å–ø–µ—Ü—ñ–∞–ª—å–Ω–æ—é —Ü—ñ–Ω–æ—é! –†–æ–∑—à–∏—Ä–µ–Ω—ñ —Ñ—É–Ω–∫—Ü—ñ—ó –¥–ª—è –∫—Ä–∞—â–æ–≥–æ —Ç—Ä–µ–∫—ñ–Ω–≥—É –Ω–∞—Å—Ç—Ä–æ—é.</p>
    </div>
  </section>

  <section class="theme-panel store-section" aria-labelledby="store-title">
    <h2 id="store-title" style="margin-top:0;" data-i18n="store_premium_title">–ü—Ä–µ–º—ñ—É–º —Ç–∞ –ø—ñ–¥—Ç—Ä–∏–º–∫–∞</h2>
    <p class="muted" style="margin-top:6px;" data-i18n="store_premium_desc">–û–±–µ—Ä–∏ Premium –¥–ª—è —Ä–æ–∑—à–∏—Ä–µ–Ω–∏—Ö –º–æ–∂–ª–∏–≤–æ—Å—Ç–µ–π –∞–±–æ –ø—ñ–¥—Ç—Ä–∏–º–∞–π –Ω–∞—Å –ø–æ–∫—É–ø–∫–æ—é –¥–æ–ø–æ–≤–Ω–µ–Ω—å.</p>

    <div class="pricing" style="display:grid; grid-template-columns: repeat(auto-fit, minmax(260px, 1fr)); gap:14px; margin-top:14px;">
      <article class="card store-plan-card" aria-label="Free plan" style="transition:all 0.3s ease;">
        <div style="display:flex; flex-direction:column; gap:10px;">
          <div>
            <div style="font-size:42px; margin-bottom:8px;">üìä</div>
            <div class="muted" style="font-weight:700; letter-spacing:.02em;" data-i18n="free_plan">Free</div>
            <h3 style="margin:4px 0 10px 0; font-weight:900;" data-i18n="free_plan">–ë–µ–∑–∫–æ—à—Ç–æ–≤–Ω–∏–π</h3>
            <div class="muted" data-i18n="free_plan_desc">–ë–∞–∑–æ–≤–∏–π —Ñ—É–Ω–∫—Ü—ñ–æ–Ω–∞–ª –¥–ª—è —â–æ–¥–µ–Ω–Ω–æ–≥–æ —Ç—Ä–µ–∫—ñ–Ω–≥—É –Ω–∞—Å—Ç—Ä–æ—é.</div>
          </div>
          <ul style="list-style:none; padding:0; margin:8px 0 0 0; display:flex; flex-direction:column; gap:6px;">
            <li data-i18n="feature_basic">‚úì –ñ—É—Ä–Ω–∞–ª –Ω–∞—Å—Ç—Ä–æ—é</li>
            <li>‚úì <span data-i18n="nav_favorites">–£–ª—é–±–ª–µ–Ω–µ</span> —Ç–∞ <span data-i18n="nav_goals">—Ü—ñ–ª—ñ</span></li>
            <li data-i18n="feature_stats">‚úì –ë–∞–∑–æ–≤–∞ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞</li>
            <li data-i18n="feature_themes">‚úó –ü—Ä–µ–º—ñ—É–º —Ç–µ–º–∏</li>
            <li data-i18n="feature_advanced_stats">‚úó –†–æ–∑—à–∏—Ä–µ–Ω–∞ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞</li>
            <li data-i18n="feature_support">‚úó –ü—Ä—ñ–æ—Ä–∏—Ç–µ—Ç–Ω–∞ –ø—ñ–¥—Ç—Ä–∏–º–∫–∞</li>
          </ul>
          <button type="button" class="btn secondary" id="freeDetailsBtn" data-i18n="more_details">–î–µ—Ç–∞–ª—å–Ω—ñ—à–µ</button>
        </div>
      </article>

      <article class="card store-plan-card" aria-label="Premium plan" style="border:1px solid rgba(147,197,253,.25); box-shadow:0 0 0 2px rgba(147,197,253,.15) inset; transition:all 0.3s ease; position:relative;">
        <div style="position:absolute; top:-12px; right:16px; background:linear-gradient(135deg, #8b5cf6 0%, #3b82f6 100%); color:#fff; padding:4px 12px; border-radius:20px; font-size:12px; font-weight:700; letter-spacing:0.5px;" data-i18n="popular_badge">–ü–û–ü–£–õ–Ø–†–ù–ï</div>
        <div style="display:flex; flex-direction:column; gap:10px;">
          <div>
            <div style="font-size:42px; margin-bottom:8px;">‚ú®</div>
            <div style="font-weight:700; color:#60a5fa; letter-spacing:.02em;" data-i18n="premium_plan">Premium</div>
            <h3 style="margin:4px 0 10px 0; font-weight:900;" data-i18n="premium_plan">–ü—Ä–µ–º—ñ—É–º</h3>
            <div class="muted" data-i18n="premium_plan_desc">–ë—ñ–ª—å—à–µ —Ç–µ–º, –≥–ª–∏–±—à–∞ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞, –ø—ñ–¥—Ç—Ä–∏–º–∫–∞ —Ä–æ–∑–≤–∏—Ç–∫—É.</div>
          </div>
          <ul style="list-style:none; padding:0; margin:8px 0 0 0; display:flex; flex-direction:column; gap:6px;">
            <li>‚úì <span data-i18n="free_plan">–£—Å—ñ –º–æ–∂–ª–∏–≤–æ—Å—Ç—ñ Free</span></li>
            <li data-i18n="feature_themes">‚úì –ü—Ä–µ–º—ñ—É–º —Ç–µ–º–∏ (—Ñ—ñ–æ–ª–µ—Ç–æ–≤–∞, –±—ñ—Ä—é–∑–æ–≤–∞, —Å–æ–Ω—è—á–Ω–∞)</li>
            <li data-i18n="feature_predictor">‚úì Mood Predictor ‚Äî –ø—Ä–æ–≥–Ω–æ–∑ –Ω–∞—Å—Ç—Ä–æ—é –Ω–∞ –∑–∞–≤—Ç—Ä–∞</li>
            <li data-i18n="feature_recommendations">‚úì Activity Recommendations ‚Äî –ø–æ—Ä–∞–¥–∏ –Ω–∞ –æ—Å–Ω–æ–≤—ñ –Ω–∞—Å—Ç—Ä–æ—é</li>
            <li data-i18n="feature_advanced_stats">‚úì –†–æ–∑—à–∏—Ä–µ–Ω–∞ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞</li>
            <li data-i18n="feature_support">‚úì –ü—Ä—ñ–æ—Ä–∏—Ç–µ—Ç–Ω–∞ –ø—ñ–¥—Ç—Ä–∏–º–∫–∞</li>
          </ul>
          <div style="display:flex; gap:8px; margin-top:6px; align-items:center;">
            <button type="button" class="btn" id="getPremiumBtn" data-i18n="get_premium">–û—Ç—Ä–∏–º–∞—Ç–∏ Premium</button>
            <button type="button" class="btn secondary" id="premiumDetailsBtn" data-i18n="more_details">–î–µ—Ç–∞–ª—å–Ω—ñ—à–µ</button>
          </div>
          <div id="premiumPrice" class="muted" style="margin-top:4px; font-weight:700;"></div>
        </div>
      </article>
    </div>

    <div id="storeProducts" style="display:grid; grid-template-columns: repeat(auto-fill, minmax(260px, 1fr)); gap:14px; margin-top:24px;">
      <article class="card" style="min-height:120px; display:flex; align-items:center; justify-content:center;">
        <div class="muted" data-i18n="loading_products">–ó–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è –ø—Ä–æ–¥—É–∫—Ç—ñ–≤‚Ä¶</div>
      </article>
    </div>

    <div id="storeEmpty" style="display:none; margin-top:16px;">
      <div style="padding:18px; text-align:center; border:1px dashed rgba(148,163,184,0.35); border-radius:14px;">
        <p class="muted" style="margin:0 0 10px 0;" data-i18n="no_products_available">–ü–æ–∫–∏ —â–æ –Ω–µ–º–∞—î —Ç–æ–≤–∞—Ä—ñ–≤.</p>
        <a href="{{ url_for('admin_products') }}" class="btn secondary" data-i18n="admin_products_title">–í—ñ–¥–∫—Ä–∏—Ç–∏ –∞–¥–º—ñ–Ω-–ø—Ä–æ–¥—É–∫—Ç–∏</a>
      </div>
    </div>
  </section>

  <!-- Why Premium Section -->
  <section class="theme-panel store-section" style="margin-top:32px;">
    <h2 style="margin-top:0; text-align:center; font-size:28px; font-weight:900;" data-i18n="why_premium_title">üíé –ß–æ–º—É –≤–∞—Ä—Ç–æ –æ–±—Ä–∞—Ç–∏ Premium?</h2>
    <p class="muted" style="text-align:center; margin-bottom:28px;" data-i18n="why_premium_subtitle">–†–æ–∑—à–∏—Ä–µ–Ω—ñ –º–æ–∂–ª–∏–≤–æ—Å—Ç—ñ –¥–ª—è –≥–ª–∏–±—à–æ–≥–æ —Ä–æ–∑—É–º—ñ–Ω–Ω—è —Ç–≤–æ–≥–æ –Ω–∞—Å—Ç—Ä–æ—é</p>
    
    <div style="display:grid; grid-template-columns: repeat(auto-fit, minmax(280px, 1fr)); gap:20px;">
      <div class="benefit-card" style="padding:24px; border-radius:14px; background:rgba(139,92,246,0.08); border:1px solid rgba(139,92,246,0.2);">
        <div style="font-size:36px; margin-bottom:12px;">üé®</div>
        <h3 style="margin:0 0 8px 0; font-weight:800; font-size:18px;" data-i18n="benefit_themes_title">–ü—Ä–µ–º—ñ—É–º —Ç–µ–º–∏</h3>
        <p class="muted" style="margin:0; font-size:14px;" data-i18n="benefit_themes_desc">–ü–µ—Ä—Å–æ–Ω–∞–ª—ñ–∑—É–π —ñ–Ω—Ç–µ—Ä—Ñ–µ–π—Å –ø—ñ–¥ —Å–≤—ñ–π –Ω–∞—Å—Ç—Ä—ñ–π –∑ —É–Ω—ñ–∫–∞–ª—å–Ω–∏–º–∏ —Ç–µ–º–∞–º–∏ –æ—Ñ–æ—Ä–º–ª–µ–Ω–Ω—è</p>
      </div>
      
      <div class="benefit-card" style="padding:24px; border-radius:14px; background:rgba(59,130,246,0.08); border:1px solid rgba(59,130,246,0.2);">
        <div style="font-size:36px; margin-bottom:12px;">üîÆ</div>
        <h3 style="margin:0 0 8px 0; font-weight:800; font-size:18px;" data-i18n="benefit_predictor_title">Mood Predictor</h3>
        <p class="muted" style="margin:0; font-size:14px;" data-i18n="benefit_predictor_desc">–ü—Ä–æ–≥–Ω–æ–∑—É–≤–∞–Ω–Ω—è —Ç–≤–æ–≥–æ –Ω–∞—Å—Ç—Ä–æ—é –Ω–∞ –æ—Å–Ω–æ–≤—ñ –∞–Ω–∞–ª—ñ–∑—É –ø–æ–ø–µ—Ä–µ–¥–Ω—ñ—Ö –∑–∞–ø–∏—Å—ñ–≤</p>
      </div>
      
      <div class="benefit-card" style="padding:24px; border-radius:14px; background:rgba(147,51,234,0.08); border:1px solid rgba(147,51,234,0.2);">
        <div style="font-size:36px; margin-bottom:12px;">üí°</div>
        <h3 style="margin:0 0 8px 0; font-weight:800; font-size:18px;" data-i18n="benefit_recommendations_title">–ü–µ—Ä—Å–æ–Ω–∞–ª—å–Ω—ñ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü—ñ—ó</h3>
        <p class="muted" style="margin:0; font-size:14px;" data-i18n="benefit_recommendations_desc">–û—Ç—Ä–∏–º—É–π –ø–æ—Ä–∞–¥–∏ –¥–ª—è –ø–æ–∫—Ä–∞—â–µ–Ω–Ω—è –Ω–∞—Å—Ç—Ä–æ—é –Ω–∞ –æ—Å–Ω–æ–≤—ñ —Ç–≤–æ—ó—Ö –¥–∞–Ω–∏—Ö</p>
      </div>
      
      <div class="benefit-card" style="padding:24px; border-radius:14px; background:rgba(168,85,247,0.08); border:1px solid rgba(168,85,247,0.2);">
        <div style="font-size:36px; margin-bottom:12px;">üìà</div>
        <h3 style="margin:0 0 8px 0; font-weight:800; font-size:18px;" data-i18n="benefit_analytics_title">–†–æ–∑—à–∏—Ä–µ–Ω–∞ –∞–Ω–∞–ª—ñ—Ç–∏–∫–∞</h3>
        <p class="muted" style="margin:0; font-size:14px;" data-i18n="benefit_analytics_desc">–î–µ—Ç–∞–ª—å–Ω–∞ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –∑ –≥—Ä–∞—Ñ—ñ–∫–∞–º–∏ —Ç–∞ —Ç—Ä–µ–Ω–¥–∞–º–∏ –¥–ª—è –∫—Ä–∞—â–æ–≥–æ —Å–∞–º–æ–ø—ñ–∑–Ω–∞–Ω–Ω—è</p>
      </div>
      
      <div class="benefit-card" style="padding:24px; border-radius:14px; background:rgba(79,70,229,0.08); border:1px solid rgba(79,70,229,0.2);">
        <div style="font-size:36px; margin-bottom:12px;">üöÄ</div>
        <h3 style="margin:0 0 8px 0; font-weight:800; font-size:18px;" data-i18n="benefit_support_title">–ü—Ä—ñ–æ—Ä–∏—Ç–µ—Ç–Ω–∞ –ø—ñ–¥—Ç—Ä–∏–º–∫–∞</h3>
        <p class="muted" style="margin:0; font-size:14px;" data-i18n="benefit_support_desc">–®–≤–∏–¥–∫–∞ –¥–æ–ø–æ–º–æ–≥–∞ –≤—ñ–¥ –∫–æ–º–∞–Ω–¥–∏ —Ç–∞ –ø–µ—Ä—à–æ—á–µ—Ä–≥–æ–≤—ñ –æ–Ω–æ–≤–ª–µ–Ω–Ω—è</p>
      </div>
      
      <div class="benefit-card" style="padding:24px; border-radius:14px; background:rgba(219,39,119,0.08); border:1px solid rgba(219,39,119,0.2);">
        <div style="font-size:36px; margin-bottom:12px;">‚ù§Ô∏è</div>
        <h3 style="margin:0 0 8px 0; font-weight:800; font-size:18px;" data-i18n="benefit_project_title">–ü—ñ–¥—Ç—Ä–∏–º–∫–∞ –ø—Ä–æ—î–∫—Ç—É</h3>
        <p class="muted" style="margin:0; font-size:14px;" data-i18n="benefit_project_desc">–î–æ–ø–æ–º–æ–∂–∏ –Ω–∞–º —Ä–æ–∑–≤–∏–≤–∞—Ç–∏—Å—å —Ç–∞ –¥–æ–¥–∞–≤–∞—Ç–∏ –Ω–æ–≤—ñ —Ñ—É–Ω–∫—Ü—ñ—ó</p>
      </div>
    </div>
  </section>

  <!-- FAQ Section -->
  <section class="theme-panel store-section" style="margin-top:32px;">
    <h2 style="margin-top:0; text-align:center; font-size:28px; font-weight:900;" data-i18n="faq_title">‚ùì –ß–∞—Å—Ç—ñ –ø–∏—Ç–∞–Ω–Ω—è</h2>
    
    <div style="max-width:800px; margin:24px auto 0; display:flex; flex-direction:column; gap:16px;">
      <details style="padding:20px; border-radius:12px; background:rgba(148,163,184,0.05); border:1px solid rgba(148,163,184,0.15); cursor:pointer;">
        <summary style="font-weight:700; font-size:16px; margin-bottom:0; cursor:pointer;" data-i18n="faq_payment_q">–Ø–∫ –ø—Ä–∞—Ü—é—î –æ–ø–ª–∞—Ç–∞ Premium?</summary>
        <p class="muted" style="margin:12px 0 0 0; font-size:14px;" data-i18n="faq_payment_a">–ü—ñ—Å–ª—è –Ω–∞—Ç–∏—Å–∫–∞–Ω–Ω—è "–ö—É–ø–∏—Ç–∏" —Ç–∏ –±—É–¥–µ—à –ø–µ—Ä–µ–Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–π –Ω–∞ –±–µ–∑–ø–µ—á–Ω—É —Å—Ç–æ—Ä—ñ–Ω–∫—É –æ–ø–ª–∞—Ç–∏. –ü—ñ—Å–ª—è —É—Å–ø—ñ—à–Ω–æ—ó –æ–ø–ª–∞—Ç–∏ Premium –∞–∫—Ç–∏–≤—É—î—Ç—å—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–Ω–æ.</p>
      </details>
      
      <details style="padding:20px; border-radius:12px; background:rgba(148,163,184,0.05); border:1px solid rgba(148,163,184,0.15); cursor:pointer;">
        <summary style="font-weight:700; font-size:16px; margin-bottom:0; cursor:pointer;" data-i18n="faq_duration_q">–ù–∞ —è–∫–∏–π —Ç–µ—Ä–º—ñ–Ω –Ω–∞–¥–∞—î—Ç—å—Å—è Premium?</summary>
        <p class="muted" style="margin:12px 0 0 0; font-size:14px;" data-i18n="faq_duration_a">Premium –Ω–∞–¥–∞—î—Ç—å—Å—è –Ω–∞ –ø–æ—Å—Ç—ñ–π–Ω—ñ–π –æ—Å–Ω–æ–≤—ñ –ø—ñ—Å–ª—è –æ–¥–Ω–æ—Ä–∞–∑–æ–≤–æ—ó –æ–ø–ª–∞—Ç–∏. –í—Å—ñ —Ñ—É–Ω–∫—Ü—ñ—ó –∑–∞–ª–∏—à–∞—é—Ç—å—Å—è –¥–æ—Å—Ç—É–ø–Ω–∏–º–∏ –±–µ–∑ –æ–±–º–µ–∂–µ–Ω—å —É —á–∞—Å—ñ.</p>
      </details>
      
      <details style="padding:20px; border-radius:12px; background:rgba(148,163,184,0.05); border:1px solid rgba(148,163,184,0.15); cursor:pointer;">
        <summary style="font-weight:700; font-size:16px; margin-bottom:0; cursor:pointer;" data-i18n="faq_data_q">–ß–∏ –∑–±–µ—Ä–µ–∂—É—Ç—å—Å—è –º–æ—ó –¥–∞–Ω—ñ –±–µ–∑ Premium?</summary>
        <p class="muted" style="margin:12px 0 0 0; font-size:14px;" data-i18n="faq_data_a">–¢–∞–∫! –í—Å—ñ —Ç–≤–æ—ó –∑–∞–ø–∏—Å–∏ —Ç–∞ –¥–∞–Ω—ñ –∑–∞–ª–∏—à–∞—é—Ç—å—Å—è —É —Ç–µ–±–µ –Ω–∞–∑–∞–≤–∂–¥–∏, –Ω–∞–≤—ñ—Ç—å —è–∫—â–æ —Ç–∏ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î—à –±–µ–∑–∫–æ—à—Ç–æ–≤–Ω—É –≤–µ—Ä—Å—ñ—é.</p>
      </details>
      
      <details style="padding:20px; border-radius:12px; background:rgba(148,163,184,0.05); border:1px solid rgba(148,163,184,0.15); cursor:pointer;">
        <summary style="font-weight:700; font-size:16px; margin-bottom:0; cursor:pointer;" data-i18n="faq_methods_q">–Ø–∫—ñ —Å–ø–æ—Å–æ–±–∏ –æ–ø–ª–∞—Ç–∏ –ø—ñ–¥—Ç—Ä–∏–º—É—é—Ç—å—Å—è?</summary>
        <p class="muted" style="margin:12px 0 0 0; font-size:14px;" data-i18n="faq_methods_a">–ú–∏ –ø—ñ–¥—Ç—Ä–∏–º—É—î–º–æ –≤—Å—ñ –ø–æ–ø—É–ª—è—Ä–Ω—ñ —Å–ø–æ—Å–æ–±–∏ –æ–ø–ª–∞—Ç–∏: –±–∞–Ω–∫—ñ–≤—Å—å–∫—ñ –∫–∞—Ä—Ç–∫–∏ (Visa, Mastercard), Google Pay, Apple Pay —Ç–∞ —ñ–Ω—à—ñ –µ–ª–µ–∫—Ç—Ä–æ–Ω–Ω—ñ –≥–∞–º–∞–Ω—Ü—ñ.</p>
      </details>
      
      <details style="padding:20px; border-radius:12px; background:rgba(148,163,184,0.05); border:1px solid rgba(148,163,184,0.15); cursor:pointer;">
        <summary style="font-weight:700; font-size:16px; margin-bottom:0; cursor:pointer;" data-i18n="faq_student_q">–ß–∏ —î –∑–Ω–∏–∂–∫–∏ –¥–ª—è —Å—Ç—É–¥–µ–Ω—Ç—ñ–≤?</summary>
        <p class="muted" style="margin:12px 0 0 0; font-size:14px;" data-i18n="faq_student_a">–¢–∞–∫! –ù–∞–ø–∏—à–∏ –Ω–∞–º –Ω–∞ support@dailymood.app –∑ –ø—ñ–¥—Ç–≤–µ—Ä–¥–∂–µ–Ω–Ω—è–º —Å—Ç—É–¥–µ–Ω—Ç—Å—å–∫–æ–≥–æ —Å—Ç–∞—Ç—É—Å—É, —ñ –º–∏ –Ω–∞–¥–∞–º–æ —Å–ø–µ—Ü—ñ–∞–ª—å–Ω—É –∑–Ω–∏–∂–∫—É.</p>
      </details>
    </div>
  </section>

    <!-- Product Details Modal -->
    <div id="productDetailsModal" style="position:fixed; inset:0; display:none; align-items:center; justify-content:center; z-index:9999;">
      <div id="productDetailsBackdrop" style="position:absolute; inset:0; background:rgba(0,0,0,.6); backdrop-filter:blur(6px);"></div>
      <div class="card" role="dialog" aria-modal="true" aria-labelledby="productDetailsTitle" style="position:relative; max-width:600px; width:calc(100% - 32px); max-height:calc(100vh - 80px); overflow-y:auto; z-index:10000; padding:32px 28px;">
        <button type="button" id="productDetailsClose" class="btn secondary" style="position:absolute; right:18px; top:18px; width:36px; height:36px; display:flex; align-items:center; justify-content:center; border-radius:10px; padding:0; font-size:20px; line-height:1;">‚úï</button>
        
        <div style="max-width:480px; margin:0 auto;">
          <h3 id="productDetailsTitle" style="margin:0 0 12px 0; font-weight:900; font-size:28px; padding-right:60px; line-height:1.2;">–¢–æ–≤–∞—Ä</h3>
          
          <div id="productDetailsPrice" style="margin-bottom:20px; font-weight:700; font-size:24px; color:#60a5fa; padding-right:60px;"></div>
          
          <div style="border-top:1px solid rgba(148,163,184,0.2); padding-top:20px; margin-bottom:20px;">
            <div id="productDetailsBody" style="font-size:15px; line-height:1.6; color:rgba(148,163,184,0.95); white-space:pre-wrap;"></div>
          </div>
          
          <div style="display:flex; flex-direction:column; gap:10px; border-top:1px solid rgba(148,163,184,0.2); padding-top:20px;">
            <button type="button" class="btn" id="productDetailsBuy" data-i18n="buy_now" style="width:100%; padding:14px; font-size:16px; font-weight:700;">–ö—É–ø–∏—Ç–∏</button>
            <button type="button" class="btn secondary" id="productDetailsCancel" data-i18n="close" style="width:100%; padding:12px;">–ó–∞–∫—Ä–∏—Ç–∏</button>
          </div>
        </div>
      </div>
    </div>
  <div id="compareModal" style="position:fixed; inset:0; display:none; align-items:center; justify-content:center; z-index:9999;">
    <div id="compareBackdrop" style="position:absolute; inset:0; background:rgba(0,0,0,.5);"></div>
    <div class="card" role="dialog" aria-modal="true" aria-labelledby="compareTitle" style="position:relative; max-width:760px; width:calc(100% - 32px); z-index:10000;">
      <button type="button" id="compareClose" class="btn secondary" style="position:absolute; right:14px; top:14px;">‚úï</button>
      <h3 id="compareTitle" style="margin:0 0 10px 0; font-weight:900;" data-i18n="compare_title">–ü–æ—Ä—ñ–≤–Ω—è–Ω–Ω—è —Ç–∞—Ä–∏—Ñ—ñ–≤</h3>
      <div class="muted" style="margin-bottom:10px;" data-i18n="compare_subtitle">–©–æ –¥–æ—Å—Ç—É–ø–Ω–æ —É Free —Ç–∞ Premium</div>
      <div style="overflow:auto;">
        <table style="width:100%; border-collapse:collapse;">
          <thead>
            <tr>
              <th style="text-align:left; padding:8px;" data-i18n="feature">–ú–æ–∂–ª–∏–≤—ñ—Å—Ç—å</th>
              <th style="text-align:center; padding:8px;" data-i18n="free_plan">Free</th>
              <th style="text-align:center; padding:8px;" data-i18n="premium_plan">Premium</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td style="padding:8px;" data-i18n="feature_basic">–ñ—É—Ä–Ω–∞–ª, —É–ª—é–±–ª–µ–Ω–µ, —Ü—ñ–ª—ñ</td>
              <td style="text-align:center; padding:8px;">‚úì</td>
              <td style="text-align:center; padding:8px;">‚úì</td>
            </tr>
            <tr>
              <td style="padding:8px;" data-i18n="feature_stats">–ë–∞–∑–æ–≤–∞ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞</td>
              <td style="text-align:center; padding:8px;">‚úì</td>
              <td style="text-align:center; padding:8px;">‚úì</td>
            </tr>
            <tr>
              <td style="padding:8px;" data-i18n="feature_themes">–ü—Ä–µ–º—ñ—É–º —Ç–µ–º–∏</td>
              <td style="text-align:center; padding:8px;">‚úó</td>
              <td style="text-align:center; padding:8px;">‚úì</td>
            </tr>
            <tr>
              <td style="padding:8px;" data-i18n="feature_predictor">Mood Predictor ‚Äî –ø—Ä–æ–≥–Ω–æ–∑ –Ω–∞—Å—Ç—Ä–æ—é</td>
              <td style="text-align:center; padding:8px;">‚úó</td>
              <td style="text-align:center; padding:8px;">‚úì</td>
            </tr>
            <tr>
              <td style="padding:8px;" data-i18n="feature_recommendations">Activity Recommendations</td>
              <td style="text-align:center; padding:8px;">‚úó</td>
              <td style="text-align:center; padding:8px;">‚úì</td>
            </tr>
            <tr>
              <td style="padding:8px;" data-i18n="feature_advanced_stats">–†–æ–∑—à–∏—Ä–µ–Ω–∞ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞</td>
              <td style="text-align:center; padding:8px;">‚úó</td>
              <td style="text-align:center; padding:8px;">‚úì</td>
            </tr>
            <tr>
              <td style="padding:8px;" data-i18n="feature_support">–ü—Ä—ñ–æ—Ä–∏—Ç–µ—Ç–Ω–∞ –ø—ñ–¥—Ç—Ä–∏–º–∫–∞</td>
              <td style="text-align:center; padding:8px;">‚úó</td>
              <td style="text-align:center; padding:8px;">‚úì</td>
            </tr>
          </tbody>
        </table>
      </div>
      <div style="display:flex; justify-content:flex-end; gap:8px; margin-top:12px;">
        <button type="button" class="btn secondary" id="compareCancel" data-i18n="close">–ó–∞–∫—Ä–∏—Ç–∏</button>
        <button type="button" class="btn" id="compareGetPremium" data-i18n="get_premium">–û—Ç—Ä–∏–º–∞—Ç–∏ Premium</button>
      </div>
    </div>
  </div>
{% endblock %}

{% block extra_scripts %}
<script>
  (function(){
    const listEl = document.getElementById('storeProducts');
    const emptyEl = document.getElementById('storeEmpty');
    const getPremiumBtn = document.getElementById('getPremiumBtn');
    const premiumDetailsBtn = document.getElementById('premiumDetailsBtn');
    const freeDetailsBtn = document.getElementById('freeDetailsBtn');
    const compareModal = document.getElementById('compareModal');
    const compareBackdrop = document.getElementById('compareBackdrop');
    const compareClose = document.getElementById('compareClose');
    const compareCancel = document.getElementById('compareCancel');
    const compareGetPremium = document.getElementById('compareGetPremium');
    const premiumPriceEl = document.getElementById('premiumPrice');

    // Product details modal refs
    const productDetailsModal = document.getElementById('productDetailsModal');
    const productDetailsBackdrop = document.getElementById('productDetailsBackdrop');
    const productDetailsClose = document.getElementById('productDetailsClose');
    const productDetailsCancel = document.getElementById('productDetailsCancel');
    const productDetailsTitle = document.getElementById('productDetailsTitle');
    const productDetailsPrice = document.getElementById('productDetailsPrice');
    const productDetailsBody = document.getElementById('productDetailsBody');
    const productDetailsBuy = document.getElementById('productDetailsBuy');

    let loadedProducts = [];

    function currency(n){
      try { return new Intl.NumberFormat('uk-UA', { style:'currency', currency:'UAH' }).format(Number(n||0)); } catch(e){ return (Number(n||0).toFixed(2) + ' –≥—Ä–Ω'); }
    }

    function findPremiumProduct(){
      const textMatch = (s='') => /premium|–ø—Ä–µ–º—ñ—É–º/i.test(String(s));
      return loadedProducts.find(p => textMatch(p.name) || textMatch(p.description));
    }

    function updatePremiumPrice(){
      const premium = findPremiumProduct();
      if(premium){ premiumPriceEl.textContent = '–¶—ñ–Ω–∞: ' + currency(premium.price); }
      else { premiumPriceEl.textContent = '–¢–∏–º—á–∞—Å–æ–≤–æ –Ω–µ–¥–æ—Å—Ç—É–ø–Ω–æ'; }
    }

    function openCompare(){ compareModal.style.display = 'flex'; }
    function closeCompare(){ compareModal.style.display = 'none'; }

    function makeCard(p){
      const el = document.createElement('article');
      el.className = 'card';
      el.style.minHeight = '120px';

      function getLocalized(field){
        try {
          const lang = (typeof currentLanguage!== 'undefined' && currentLanguage) ? currentLanguage : 'uk';
          const key = lang === 'en' ? `${field}_en` : field;
          return (p && (p[key] || p[field])) || '';
        } catch(e){ return (p && p[field]) || ''; }
      }
      const name = getLocalized('name') || '–¢–æ–≤–∞—Ä';
      const desc = getLocalized('description') || '';
      const price = currency((p && p.price) || 0);

      el.innerHTML = `
        <div style="display:flex; flex-direction:column; gap:8px; align-items:flex-start; width:100%;">
          <div style="display:flex; justify-content:space-between; align-items:flex-start; gap:10px; width:100%;">
            <h3 style="margin:0; font-size:1.2rem; font-weight:800;">${name}</h3>
            <div style="font-weight:800; opacity:0.9;">${price}</div>
          </div>
          <p class="muted" style="margin:0;">${desc}</p>
          <div style="display:flex; gap:8px; margin-top:6px;">
            <button type="button" class="btn" data-product-id="${p.id}" data-i18n="buy_now">–ö—É–ø–∏—Ç–∏</button>
            <button type="button" class="btn secondary" data-product-id="${p.id}" data-action="details" data-i18n="more_details">–î–µ—Ç–∞–ª—ñ</button>
          </div>
        </div>`;

      const buyBtn = el.querySelector('button.btn');
      const detailsBtn = el.querySelector('button[data-action="details"]');
      if(buyBtn){ buyBtn.addEventListener('click', () => buyNow(p)); }
      if(detailsBtn){
        detailsBtn.addEventListener('click', () => {
          // Populate product details modal
          productDetailsTitle.textContent = name;
          productDetailsPrice.textContent = price ? ('–¶—ñ–Ω–∞: ' + price) : '';
          productDetailsBody.textContent = desc || ((typeof currentLanguage!=='undefined' && currentLanguage==='en') ? 'No description' : '–ë–µ–∑ –æ–ø–∏—Å—É');
          productDetailsBuy.onclick = () => buyNow(p);
          productDetailsModal.style.display = 'flex';
        });
      }
      // Close handlers
      [productDetailsClose, productDetailsCancel, productDetailsBackdrop].forEach(btn => {
        btn && btn.addEventListener('click', () => { productDetailsModal.style.display = 'none'; });
      });
      return el;
    }

    async function loadProducts(){
      try {
        const r = await fetch('/api/products', { credentials:'include' });
        if(!r.ok) throw new Error('load');
        const products = await r.json();
        loadedProducts = Array.isArray(products) ? products : [];
        listEl.innerHTML = '';
        if(loadedProducts.length === 0){
          emptyEl.style.display = '';
        } else {
          emptyEl.style.display = 'none';
          loadedProducts.forEach(p => listEl.appendChild(makeCard(p)));
        }
        updatePremiumPrice();
      } catch(err){
        listEl.innerHTML = '<article class="card"><div class="muted">–ù–µ –≤–¥–∞–ª–æ—Å—è –∑–∞–≤–∞–Ω—Ç–∞–∂–∏—Ç–∏ –º–∞–≥–∞–∑–∏–Ω.</div></article>';
        console.error('Store load failed', err);
        updatePremiumPrice();
      }
    }

    async function buyNow(product){
      try {
        const r = await fetch('/api/orders', {
          method: 'POST',
          credentials: 'include',
          headers: { 'Content-Type': 'application/json' },
          body: JSON.stringify({ items: [{ product_id: product.id, quantity: 1 }] })
        });
        if(r.status === 401){
          window.location.href = '/auth/login?next=' + encodeURIComponent('/store');
          return;
        }
        if(!r.ok) throw new Error('order');
        const payload = await r.json();
        const orderId = payload && payload.order ? payload.order.id : null;
        if(orderId){
          // –†–µ–¥—ñ—Ä–µ–∫—Ç –Ω–∞ —Å—Ç–æ—Ä—ñ–Ω–∫—É –æ–ø–ª–∞—Ç–∏
          window.location.href = '/checkout?order_id=' + orderId;
        } else {
          alert('–ó–∞–º–æ–≤–ª–µ–Ω–Ω—è —Å—Ç–≤–æ—Ä–µ–Ω–æ, –∞–ª–µ –Ω–µ –≤–¥–∞–ª–æ—Å—è –ø–µ—Ä–µ–π—Ç–∏ –¥–æ –æ–ø–ª–∞—Ç–∏.');
        }
      } catch(err){
        alert('–ù–µ –≤–¥–∞–ª–æ—Å—è –æ—Ñ–æ—Ä–º–∏—Ç–∏ –∑–∞–º–æ–≤–ª–µ–Ω–Ω—è. –°–ø—Ä–æ–±—É–π—Ç–µ —â–µ —Ä–∞–∑.');
        console.error('Buy failed', err);
      }
    }

    getPremiumBtn.addEventListener('click', async () => {
      const premium = findPremiumProduct();
      if(premium){
        buyNow(premium);
        return;
      }

      // –Ø–∫—â–æ —Ç–æ–≤–∞—Ä "–ü—Ä–µ–º—ñ—É–º" –≤—ñ–¥—Å—É—Ç–Ω—ñ–π —É products, —ñ–Ω—ñ—Ü—ñ—é—î–º–æ –æ–∫—Ä–µ–º–µ –∑–∞–º–æ–≤–ª–µ–Ω–Ω—è –¥–ª—è Premium
      try {
        const r = await fetch('/api/premium/initiate', {
          method: 'POST',
          credentials: 'include',
          headers: { 'Content-Type': 'application/json' },
          body: JSON.stringify({ price: 0 })
        });
        if(r.status === 401){
          window.location.href = '/auth/login?next=' + encodeURIComponent('/store');
          return;
        }
        if(!r.ok) throw new Error('initiate');
        const payload = await r.json();
        const orderId = payload && payload.order_id;
        if(orderId){
          // –†–µ–¥—ñ—Ä–µ–∫—Ç –Ω–∞ —Å—Ç–æ—Ä—ñ–Ω–∫—É –æ–ø–ª–∞—Ç–∏
          window.location.href = '/checkout?order_id=' + orderId;
        } else {
          alert('–ù–µ –≤–¥–∞–ª–æ—Å—è –æ—Ñ–æ—Ä–º–∏—Ç–∏ –∑–∞–º–æ–≤–ª–µ–Ω–Ω—è –¥–ª—è Premium. –°–ø—Ä–æ–±—É–π—Ç–µ –ø—ñ–∑–Ω—ñ—à–µ.');
        }
      } catch(err){
        console.error('Premium initiate failed', err);
        alert('–ù–µ –≤–¥–∞–ª–æ—Å—è –æ—Ñ–æ—Ä–º–∏—Ç–∏ –∑–∞–º–æ–≤–ª–µ–Ω–Ω—è. –°–ø—Ä–æ–±—É–π—Ç–µ —â–µ —Ä–∞–∑.');
      }
    });

    premiumDetailsBtn.addEventListener('click', openCompare);
    freeDetailsBtn.addEventListener('click', openCompare);
    compareBackdrop.addEventListener('click', closeCompare);
    compareClose.addEventListener('click', closeCompare);
    compareCancel.addEventListener('click', closeCompare);
    compareGetPremium.addEventListener('click', () => { closeCompare(); getPremiumBtn.click(); });

    // Hover effects for plan cards
    document.querySelectorAll('.store-plan-card').forEach(card => {
      card.addEventListener('mouseenter', function() {
        this.style.transform = 'translateY(-4px)';
        this.style.boxShadow = '0 12px 24px rgba(0,0,0,0.15)';
      });
      card.addEventListener('mouseleave', function() {
        this.style.transform = 'translateY(0)';
        this.style.boxShadow = '';
      });
    });

    loadProducts();
  })();
</script>
{% endblock %}
